{
  "package_name": "craftcms/cms",
  "patch_versions": [
    "5.8.21",
    "4.16.17"
  ],
  "vulnerable_ranges": [
    [
      "5.0.0",
      "5.8.20"
    ],
    [
      "4.0.0",
      "4.16.16"
    ]
  ],
  "cwe": [
    "CWE-918"
  ],
  "tldr": "Affected versions of this package are vulnerable to Server-Side Request Forgery (SSRF) due to insufficient validation of user-supplied URLs in file handling code; the old code would accept any URL and attempt to fetch it, allowing an attacker to specify internal, loopback, or cloud metadata service addresses, but the patch mitigates this by validating that the hostname is a valid alphanumeric domain and not an IP address, thereby blocking attempts to exploit the server's trust relationship to probe internal networks or access sensitive data.",
  "doest_this_affect_me": "You are affected if you are using a version that falls within the vulnerable range.",
  "how_to_fix": "Upgrade the `craftcms/cms` library to the patch version.",
  "vulnerable_to": "Server-Side Request Forgery (SSRF)",
  "related_cve_id": "GHSA-x27p-wfqw-hfcc",
  "language": "PHP",
  "severity_class": "MEDIUM",
  "aikido_score": 55,
  "changelog": "https://github.com/craftcms/cms/releases/tag/5.8.21",
  "last_modified": "2025-12-10",
  "published": "2025-12-10"
}
